{% extends "base.html" %}

{% block within_head %}
    <link rel="stylesheet" href="//cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css">
    <script src="//cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <script>
      $(document).ready( function () {
        $('#managed_artists_table').dataTable({"lengthChange": false});
      } );
    </script>
<style>
    body {
        max-width: 1500px;
        margin: auto;
        padding: 20px;
    }
    img {
        max-width: 100%;
    }
</style>
{% endblock %}

{% block body %}
<h1>Spotify + Anki</h1>
<h2>How to Import new Songs</h2>
Download the <a href="/spotify/anki_import">latest CSV of songs</a> (be patient, this may take up to a minute). In Anki, use File > Import..., select the downloaded CSV file, and use the "Spotify Track" note type:<br>
<img src="/static/images/import_spotify_track.png">
<h2>How this app works</h2>
This app uses the concept of an "artist under management": this is an artist that you have decided you'd like to be familiar with. Once you add a selection of such artists (see below), the app will automatically import the top 3 most-popular songs from their <a href="https://support.spotify.com/us/using_spotify/features/artist-profile/">profile page</a>, as well as <a href="https://support.spotify.com/us/article/what-is-your-music/">any songs that you've liked</a> from that artist.
<h2><a name="AUM">Artists Under Management</a></h2>
    {% if not totals_given %}
        <a href="?total_track_counts#AUM">Show total track count for artists</a> (includes top + liked; warning, this will take a while)
    {% endif %}
<table id="managed_artists_table">
<thead>
    <tr>
        <th>Artist Name</th>
        <th>Lifetime Plays</th>
        <th>Date Added</th>
        <th>Number of Top Tracks</th>
        {% if totals_given %}<th>Number of Total Tracks</th>{% endif %}
    </tr>
</thead>
<tbody>
{% for name, uri, plays, date_added, num_top_tracks, num_total_tracks in managed_artists %}
    <tr>
        <td><a href="https://open.spotify.com/artist/{{ uri }}" target="_blank">{{ name }}</a></td>
        <td class="dt-body-right">{% if plays %}{{ plays }}{% endif %}</td>
        <td class="dt-body-right">{{ date_added }}</td>
        <td class="dt-body-right">{{ num_top_tracks }}</td>
        {% if totals_given %}<td class="dt-body-right">{{ num_total_tracks }}</td>{% endif %}
    </tr>
{% endfor %}
</tbody>
</table>
<h2>How to Add a New Artist</h2>
Search for the artist you'd like to add and go to their artist page. Then, click follow. See below for a screenshot.<br>
<img src="/static/images/how_to_find_spotify_follow_button.png">
{% endblock %}